const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/MyImagesPage-j1bS6M-T.js","assets/vendor-router-B0usbLSA.js","assets/vendor-react-CA82q7Og.js","assets/vendor-utils-DBrOFRqy.js","assets/vendor-supabase-l0Uqy5La.js","assets/vendor-clerk-TSkbXxwZ.js","assets/ProfilePage-BIV9J65E.js","assets/AuthConfirmPage-pt8O6gMj.js","assets/ResetPasswordPage-Kr8zNiZf.js"])))=>i.map(i=>d[i]);
import{r as Ie,a as ke}from"./vendor-react-CA82q7Og.js";import{r as l,a as Ce,R as Ee,u as _e,B as Re,b as Pe,c as R}from"./vendor-router-B0usbLSA.js";import{c as Te,_ as M}from"./vendor-supabase-l0Uqy5La.js";import{o as Ae,u as he,a as Fe,r as Ue,S as $e,b as Le,C as De}from"./vendor-clerk-TSkbXxwZ.js";import{X as Z,I as se,T as Be,C as Oe,a as ze,b as qe,U as He,c as H,d as xe,e as Ye,H as Me,L as Ge,S as re,Z as fe,f as Je,W as We,g as Ve,h as Ke,i as Ze,P as ae,R as Y,D as Xe,j as Qe,k as et,l as tt,m as st,G as rt,n as at}from"./vendor-utils-DBrOFRqy.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))a(n);new MutationObserver(n=>{for(const o of n)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&a(i)}).observe(document,{childList:!0,subtree:!0});function r(n){const o={};return n.integrity&&(o.integrity=n.integrity),n.referrerPolicy&&(o.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?o.credentials="include":n.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function a(n){if(n.ep)return;n.ep=!0;const o=r(n);fetch(n.href,o)}})();var V={exports:{}},U={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var oe;function ot(){if(oe)return U;oe=1;var t=Ie(),s=Symbol.for("react.element"),r=Symbol.for("react.fragment"),a=Object.prototype.hasOwnProperty,n=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,o={key:!0,ref:!0,__self:!0,__source:!0};function i(x,h,y){var p,v={},c=null,d=null;y!==void 0&&(c=""+y),h.key!==void 0&&(c=""+h.key),h.ref!==void 0&&(d=h.ref);for(p in h)a.call(h,p)&&!o.hasOwnProperty(p)&&(v[p]=h[p]);if(x&&x.defaultProps)for(p in h=x.defaultProps,h)v[p]===void 0&&(v[p]=h[p]);return{$$typeof:s,type:x,key:c,ref:d,props:v,_owner:n.current}}return U.Fragment=r,U.jsx=i,U.jsxs=i,U}var ne;function nt(){return ne||(ne=1,V.exports=ot()),V.exports}var e=nt(),ie={},it="@vercel/speed-insights",lt="1.2.0",ct=()=>{window.si||(window.si=function(...s){(window.siq=window.siq||[]).push(s)})};function dt(){return typeof window<"u"}function ut(){try{const t="production"}catch{}return"production"}function pe(){return ut()==="development"}function mt(t){return t.scriptSrc?t.scriptSrc:pe()?"https://va.vercel-scripts.com/v1/speed-insights/script.debug.js":t.dsn?"https://va.vercel-scripts.com/v1/speed-insights/script.js":t.basePath?`${t.basePath}/speed-insights/script.js`:"/_vercel/speed-insights/script.js"}function gt(t={}){var s;if(!dt()||t.route===null)return null;ct();const r=mt(t);if(document.head.querySelector(`script[src*="${r}"]`))return null;t.beforeSend&&((s=window.si)==null||s.call(window,"beforeSend",t.beforeSend));const a=document.createElement("script");return a.src=r,a.defer=!0,a.dataset.sdkn=it+(t.framework?`/${t.framework}`:""),a.dataset.sdkv=lt,t.sampleRate&&(a.dataset.sampleRate=t.sampleRate.toString()),t.route&&(a.dataset.route=t.route),t.endpoint?a.dataset.endpoint=t.endpoint:t.basePath&&(a.dataset.endpoint=`${t.basePath}/speed-insights/vitals`),t.dsn&&(a.dataset.dsn=t.dsn),pe()&&t.debug===!1&&(a.dataset.debug="false"),a.onerror=()=>{console.log(`[Vercel Speed Insights] Failed to load script from ${r}. Please check if any content blockers are enabled and try again.`)},document.head.appendChild(a),{setRoute:n=>{a.dataset.route=n??void 0}}}function ht(){if(!(typeof process>"u"||typeof ie>"u"))return ie.REACT_APP_VERCEL_OBSERVABILITY_BASEPATH}function xt(t){l.useEffect(()=>{var r;t.beforeSend&&((r=window.si)==null||r.call(window,"beforeSend",t.beforeSend))},[t.beforeSend]);const s=l.useRef(null);return l.useEffect(()=>{if(s.current)t.route&&s.current(t.route);else{const r=gt({framework:t.framework??"react",basePath:t.basePath??ht(),...t});r&&(s.current=r.setRoute)}},[t.route]),null}var z={},le;function ft(){if(le)return z;le=1;var t=ke();return z.createRoot=t.createRoot,z.hydrateRoot=t.hydrateRoot,z}var pt=ft();const we=l.createContext(void 0),wt=({children:t})=>{const[s,r]=l.useState([]),a=l.useCallback(()=>`toast_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,[]),n=l.useCallback(c=>{r(d=>d.filter(m=>m.id!==c))},[]),o=l.useCallback(c=>{const d=a(),m={id:d,duration:5e3,...c};return r(f=>[...f,m]),m.duration&&m.duration>0&&setTimeout(()=>{n(d)},m.duration),d},[a,n]),i=l.useCallback(()=>{r([])},[]),x=l.useCallback((c,d,m)=>o({type:"success",title:c,message:d,...m}),[o]),h=l.useCallback((c,d,m)=>o({type:"error",title:c,message:d,duration:7e3,...m}),[o]),y=l.useCallback((c,d,m)=>o({type:"warning",title:c,message:d,duration:6e3,...m}),[o]),p=l.useCallback((c,d,m)=>o({type:"info",title:c,message:d,...m}),[o]),v={toasts:s,addToast:o,removeToast:n,clearAllToasts:i,showSuccess:x,showError:h,showWarning:y,showInfo:p};return e.jsx(we.Provider,{value:v,children:t})},L=()=>{const t=l.useContext(we);if(!t)throw new Error("useToast must be used within a ToastProvider");return t},bt=({toast:t,onRemove:s})=>{const[r,a]=l.useState(!1),[n,o]=l.useState(!1);l.useEffect(()=>{const c=setTimeout(()=>a(!0),50);return()=>clearTimeout(c)},[]);const i=()=>{o(!0),setTimeout(()=>s(t.id),300)},[x,h]=l.useState(100);l.useEffect(()=>{if(!t.duration||t.duration<=0)return;const c=setInterval(()=>{h(d=>{const m=100/t.duration*100;return Math.max(0,d-m)})},100);return()=>clearInterval(c)},[t.duration]);const y=()=>{const c="relative overflow-hidden glass border-l-4";switch(t.type){case"success":return`${c} border-green-500 bg-green-500/10`;case"error":return`${c} border-red-500 bg-red-500/10`;case"warning":return`${c} border-yellow-500 bg-yellow-500/10`;case"info":return`${c} border-blue-500 bg-blue-500/10`;default:return`${c} border-gray-500 bg-gray-500/10`}},p=()=>{const c="w-5 h-5";switch(t.type){case"success":return e.jsx(ze,{className:`${c} text-green-400`});case"error":return e.jsx(Oe,{className:`${c} text-red-400`});case"warning":return e.jsx(Be,{className:`${c} text-yellow-400`});case"info":return e.jsx(se,{className:`${c} text-blue-400`});default:return e.jsx(se,{className:`${c} text-gray-400`})}},v=()=>{switch(t.type){case"success":return"bg-green-500";case"error":return"bg-red-500";case"warning":return"bg-yellow-500";case"info":return"bg-blue-500";default:return"bg-gray-500"}};return e.jsxs("div",{className:`
        rounded-xl p-4 max-w-sm w-full transition-all duration-300 transform
        ${y()}
        ${r&&!n?"translate-x-0 opacity-100 scale-100":"translate-x-full opacity-0 scale-95"}
      `,role:"alert","aria-live":"polite",children:[t.duration&&t.duration>0&&e.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-1 bg-white/10",children:e.jsx("div",{className:`h-full transition-all duration-100 linear ${v()}`,style:{width:`${x}%`}})}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"flex-shrink-0 mt-0.5",children:p()}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h4",{className:"text-white font-medium text-sm leading-5",children:t.title}),t.message&&e.jsx("p",{className:"text-gray-300 text-sm mt-1 leading-5",children:t.message}),t.action&&e.jsx("div",{className:"mt-3",children:e.jsx("button",{onClick:t.action.onClick,className:"text-sm font-medium text-blue-400 hover:text-blue-300 transition-colors duration-200",children:t.action.label})})]}),e.jsx("button",{onClick:i,className:"flex-shrink-0 text-gray-400 hover:text-white transition-colors duration-200 p-1 rounded-lg hover:bg-white/10","aria-label":"Close notification",children:e.jsx(Z,{className:"w-4 h-4"})})]})]})},yt=()=>{const{toasts:t,removeToast:s}=L(),r=e.jsx("div",{className:"fixed top-4 right-4 z-[100] space-y-3 pointer-events-none",children:t.map(a=>e.jsx("div",{className:"pointer-events-auto",children:e.jsx(bt,{toast:a,onRemove:s})},a.id))});return t.length===0||typeof document>"u"?null:Ce.createPortal(r,document.body)},$="pk_test_YWJsZS1saW9uLTI5LmNsZXJrLmFjY291bnRzLmRldiQ",ce=t=>{try{const s=t.split(".");return s.length!==3?null:JSON.parse(atob(s[1]))}catch(s){return console.error("Failed to decode JWT:",s),null}},be=()=>!$.includes("YOUR_CLERK_PUBLISHABLE_KEY")&&$.startsWith("pk_"),K=be()?new Ae($):null,vt=async()=>{try{const t=window?.Clerk;if(t?.session){try{const r=await t.session.getToken({template:"supabase"});if(r){const a=ce(r);return console.log("‚úÖ Using Clerk Supabase JWT template"),console.log("üîë JWT Claims:",{sub:a?.sub,user_id:a?.user_id,iss:a?.iss,exp:a?.exp?new Date(a.exp*1e3).toISOString():"unknown"}),r}}catch{console.warn("‚ö†Ô∏è Supabase template not configured in Clerk, using default token")}const s=await t.session.getToken();if(s){const r=ce(s);return console.log("‚úÖ Using default Clerk JWT token"),console.log("üîë JWT Claims:",{sub:r?.sub,user_id:r?.user_id,iss:r?.iss,exp:r?.exp?new Date(r.exp*1e3).toISOString():"unknown"}),s}}if(K?.session){try{const r=await K.session.getToken({template:"supabase"});if(r)return r}catch{console.warn("Supabase template not configured in Clerk, using default token")}const s=await K.session.getToken();if(s)return s}return console.warn("No active Clerk session found"),null}catch(t){return console.error("Error getting Clerk token:",t),null}};class de{static DIMENSIONS={"16:9":{width:1024,height:576},"4:3":{width:768,height:576},"1:1":{width:768,height:768}};static BASE_URL="https://image.pollinations.ai/prompt/";static generateImage(s){if(!s.prompt?.trim())throw new Error("Prompt is required");const r=s.prompt.trim(),a=s.aspectRatio||"1:1",n=this.DIMENSIONS[a]||this.DIMENSIONS["1:1"],o=`${r}, masterpiece, best quality, highly detailed`,i=Date.now()%1e6+Math.floor(Math.random()*1e3),x=encodeURIComponent(o),h=`${this.BASE_URL}${x}?width=${n.width}&height=${n.height}&seed=${i}&enhance=true&nologo=true&model=flux&steps=20`;return{id:`pollinations_${Date.now()}_${Math.random().toString(36).slice(2,11)}`,url:h,prompt:r,aspectRatio:a,timestamp:new Date}}static generateVariations(s,r=3){if(!s.prompt?.trim())throw new Error("Prompt is required");const a=[];for(let n=0;n<r;n++){const o={...s,prompt:n===0?s.prompt:`${s.prompt}, variation ${n+1}`};setTimeout(()=>{const i=this.generateImage(o);a.push(i)},n*10)}return a}static getDimensions(s){return this.DIMENSIONS[s]||this.DIMENSIONS["1:1"]}static testApiKey(){return!0}static preloadImage(s){return new Promise((r,a)=>{const n=new Image;n.onload=()=>r(),n.onerror=a,n.src=s})}static async generateAndPreload(s){const r=this.generateImage(s);return this.preloadImage(r.url).catch(()=>{}),r}}const X="https://dxljyzvwolnbdreewbvs.supabase.co",Q="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImR4bGp5enZ3b2xuYmRyZWV3YnZzIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTcyNTY0OTksImV4cCI6MjA3MjgzMjQ5OX0.hzNFBkxNMS6BwToieigRze1GEq_OSpzrXJpH92o0ouU",ye=()=>!X.includes("YOUR_SUPABASE_URL")&&!Q.includes("YOUR_SUPABASE_ANON_KEY")&&!X.includes("API_KEY_ADDED"),jt=()=>ye()?Te(X,Q,{global:{fetch:async(t,s={})=>{const r=await vt();s.headers={apikey:Q,...s.headers};const a=t.toString();if(a.includes("/rest/v1/"))(s.headers||{})["Content-Type"]||(s.headers={...s.headers,"Content-Type":"application/json"});else if(a.includes("/storage/v1/object/")){const n=s.headers||{},o=s.body&&(s.body instanceof Blob||s.body instanceof File||s.body instanceof FormData);s.body&&!n["Content-Type"]&&!o&&(s.headers={...s.headers,"Content-Type":"application/json"})}if(r?(s.headers={...s.headers,Authorization:`Bearer ${r}`},console.log("Supabase request with valid token (length:",r.length,")")):console.warn("‚ö†Ô∏è  No Clerk token available for Supabase request - this will likely cause 400/401 errors"),a.includes("/storage/v1/object/")&&console.log("Storage API request:",{url:a,method:s.method,headers:s.headers,body:s.body}),a.includes("/storage/v1/object/")&&s.body&&!(s.body instanceof Blob||s.body instanceof File||s.body instanceof FormData)&&typeof s.body=="string")try{const o=JSON.parse(s.body);s.body=JSON.stringify(o)}catch(o){console.warn("Failed to parse storage request body:",o)}return fetch(t,s)}}}):null,k=jt(),ue=async()=>k,Nt=t=>t?.id||null,St=t=>t?.emailAddresses?.[0]?.emailAddress||void 0,It=t=>t?.fullName||void 0,kt=t=>t?.imageUrl||void 0,G=()=>{const{user:t,isLoaded:s,isSignedIn:r}=he(),a=Fe(),[n,o]=l.useState(!0),[i,x]=l.useState(!1),h=t?{id:t.id,emailAddresses:t.emailAddresses.map(w=>({emailAddress:w.emailAddress})),firstName:t.firstName,lastName:t.lastName,imageUrl:t.imageUrl,fullName:t.fullName}:null;return l.useEffect(()=>{const w=be()&&ye();x(w),s&&o(!1)},[s]),{user:h,loading:n||!s,isConfigured:i,isSignedIn:!!r,signIn:async(w,b)=>{if(!i)throw new Error("Authentication not configured");try{const u=await a.client.signIn.create({identifier:w,password:b});if(u.status==="complete")return await a.setActive({session:u.createdSessionId}),{user:u};throw new Error("Sign in incomplete")}catch(u){throw new Error(u.message||"Sign in failed")}},signUp:async(w,b,u)=>{if(!i)throw new Error("Authentication not configured");try{const[I,...E]=(u||"").split(" "),C=E.join(" "),S=await a.client.signUp.create({emailAddress:w,password:b,firstName:I||void 0,lastName:C||void 0});return await S.prepareEmailAddressVerification({strategy:"email_code"}),{user:S,needsVerification:!0}}catch(I){throw new Error(I.message||"Sign up failed")}},signOut:async()=>{if(i)try{await a.signOut(),(window.location.pathname.startsWith("/sign-")||window.location.pathname.startsWith("/factor"))&&window.history.replaceState(null,"","/")}catch(w){throw new Error(w.message||"Sign out failed")}},resetPassword:async w=>{if(!i)throw new Error("Authentication not configured");try{await a.client.signIn.create({identifier:w,strategy:"reset_password_email_code"})}catch(b){throw new Error(b.message||"Password reset failed")}},updateProfile:async w=>{if(!i)throw new Error("Authentication not configured");if(!h)throw new Error("No user logged in");try{const b={};if(w.full_name){const[u,...I]=w.full_name.split(" ");b.firstName=u,b.lastName=I.join(" ")}return await t?.update(b),{user:t}}catch(b){throw new Error(b.message||"Profile update failed")}},updateProfileImage:async w=>{if(!i)throw new Error("Authentication not configured");if(!a.user)throw new Error("No user logged in");try{return await a.user.setProfileImage({file:w}),{user:a.user}}catch(b){throw new Error(b.message||"Profile image update failed")}},updateEmail:async(w,b)=>{if(!i)throw new Error("Authentication not configured");if(!h)throw new Error("No user logged in");try{if(b){const I=t?.emailAddresses?.[0]?.emailAddress;if(!I)throw new Error("Current email not found");const E=await a.client.signIn.create({identifier:I,password:b});if(E.status==="complete")await a.setActive({session:E.createdSessionId});else throw new Error("Re-authentication failed")}const u=await t?.createEmailAddress({email:w});if(!u)throw new Error("Failed to create new email address");return await u.prepareVerification({strategy:"email_code"}),{user:t}}catch(u){throw new Error(u.message||"Email update failed")}},verifyEmailUpdate:async(w,b)=>{if(!i)throw new Error("Authentication not configured");if(!t)throw new Error("No user logged in");try{const u=t.emailAddresses.find(I=>I.emailAddress===w);if(!u)throw new Error("New email not found on account");return await u.attemptVerification({code:b}),await t.update({primaryEmailAddressId:u.id}),{user:t}}catch(u){throw new Error(u.message||"Email verification failed")}},updatePassword:async w=>{if(!i)throw new Error("Authentication not configured");if(!h)throw new Error("No user logged in");try{return await t?.updatePassword({newPassword:w}),{user:t}}catch(b){throw new Error(b.message||"Password update failed")}}}},Ct=()=>{const[t,s]=l.useState([]),[r,a]=l.useState(!1),{user:n,isConfigured:o}=G(),i=Nt(n),x=l.useCallback(async()=>{if(!o||!i||!k){console.log("fetchSavedImages skipped:",{isConfigured:o,userId:!!i,supabase:!!k});return}a(!0);try{const{data:c,error:d}=await k.from("saved_images").select("*").eq("user_id",i).order("created_at",{ascending:!1});if(d)throw console.error("Fetch saved images error:",d),d;const m=(c||[]).filter(f=>!f||typeof f!="object"||!f.id?(console.warn("Invalid image data found:",f),!1):!0);s(m)}catch(c){console.error("Fetch saved images error:",c)}finally{a(!1)}},[o,i]);l.useEffect(()=>{i&&o?x():s([])},[i,o,x]);const h=l.useRef(new Set);return{savedImages:t,loading:r,saveImage:async(c,d,m,f="pollinations")=>{if(!o||!i||!k)return console.warn("Cannot save image: not configured or missing user/supabase"),null;const g=`${i}:${d}`;if(h.current.has(g))return console.log("‚è≥ Save already in progress for this image, skipping duplicate save"),null;h.current.add(g),console.log("saveImage called with:",{prompt:c.substring(0,50),generatedImageUrl:d,aspectRatio:m,style:f,userId:i});try{const{data:j}=await k.from("saved_images").select("id, prompt, image_url").eq("user_id",i).eq("image_url",d).limit(1).maybeSingle();if(j?.id)return console.log("üîç Found existing image with same URL, skipping save:",j.id),h.current.delete(g),j;const w=f==="vivid"||f==="natural"?f:"vivid";let b=!1;try{console.log("üñºÔ∏è Attempting to fetch image for storage upload:",d.substring(0,100)+"..."),console.log("üë§ Current user ID:",i);let S=null,J=null;const D=3;for(let N=1;N<=D;N++)try{if(console.log(`üîÑ Fetch attempt ${N}/${D}`),S=await fetch(d,{mode:"cors",signal:AbortSignal.timeout(3e4)}),S.ok){console.log("‚úÖ Fetch successful on attempt",N);break}else console.warn(`‚ö†Ô∏è Fetch failed with status ${S.status} on attempt ${N}`),J=new Error(`HTTP ${S.status}: ${S.statusText}`),N<D&&await new Promise(T=>setTimeout(T,1e3*N))}catch(T){console.warn(`‚ö†Ô∏è Fetch error on attempt ${N}:`,T.message),J=T,N<D&&await new Promise(B=>setTimeout(B,1e3*N))}if(!S||!S.ok)throw J||new Error("Failed to fetch image after retries");if(console.log("üì• Fetch response status:",S.status,S.statusText),S.ok){const N=await S.blob();if(console.log("‚úÖ Image blob fetched:",{type:N.type,size:N.size}),N.size>0&&N.type.startsWith("image/")){console.log("‚úÖ Blob is valid image, proceeding with storage upload");const T=N.type.split("/")[1]||"jpg",B=`${Date.now()}_${Math.random().toString(36).slice(2,9)}.${T}`,A=`${i}/${B}`;console.log("üì§ Uploading to storage:",{filePath:A,size:N.size,type:N.type,userId:i,fileName:B});const W=await ue();if(!W)throw console.error("‚ùå Storage client not available!"),new Error("Storage client not available");const{error:F,data:Se}=await W.storage.from("generated_images").upload(A,N,{cacheControl:"3600",upsert:!1,contentType:N.type});if(F)throw console.error("‚ùå Storage upload failed:",{error:F,message:F.message,statusCode:F.statusCode,filePath:A,userId:i}),F;console.log("‚úÖ Storage upload successful:",Se);const{data:{publicUrl:O}}=W.storage.from("generated_images").getPublicUrl(A);if(!O)throw console.error("‚ùå Failed to get public URL"),new Error("Failed to get public URL");console.log("‚úÖ Public URL obtained:",O.substring(0,100)+"...");const P={user_id:i,prompt:c,image_url:O,aspect_ratio:m,style:w,is_favorite:!1,storage_file_path:A},{data:ee}=await k.from("saved_images").select("id").eq("user_id",i).eq("image_url",O).limit(1).maybeSingle();if(ee?.id)return console.log("‚ÑπÔ∏è Duplicate detected (storage URL), skipping insert"),h.current.delete(g),setTimeout(()=>x(),500),ee;console.log("üíæ Saving to database with storage URL"),console.log("üíæ Insert data:",{user_id:P.user_id,prompt:P.prompt.substring(0,50)+"...",image_url:P.image_url.substring(0,100)+"...",aspect_ratio:P.aspect_ratio,style:P.style,storage_file_path:P.storage_file_path});const{data:te,error:_}=await k.from("saved_images").insert(P).select().single();if(_){if(_.code==="23505"||_.message?.includes("duplicate"))return console.log("‚ö†Ô∏è Unique constraint violation - image already exists"),h.current.delete(g),setTimeout(()=>x(),500),b=!0,null;throw console.error("‚ùå Database insert failed:",{error:_,message:_.message,code:_.code,details:_.details,hint:_.hint}),_}return console.log("‚úÖ Storage upload + database insert successful!",te?"with data":"without returned data"),h.current.delete(g),setTimeout(()=>x(),500),b=!0,te||{}}else console.warn("‚ö†Ô∏è Invalid blob: size="+N.size+", type="+N.type)}else console.error("‚ùå Fetch failed:",S.status,S.statusText)}catch(S){console.error("‚ùå Storage upload failed, will use fallback:",S)}if(b)return console.log("‚úÖ Storage upload was completed, no need for fallback"),null;console.log("üìå Using direct URL fallback");const u={user_id:i,prompt:c,image_url:d,aspect_ratio:m,style:w,is_favorite:!1},{data:I}=await k.from("saved_images").select("id").eq("user_id",i).eq("image_url",d).limit(1).maybeSingle();if(I?.id)return console.log("‚ÑπÔ∏è Duplicate detected (direct URL), skipping insert"),h.current.delete(g),setTimeout(()=>x(),500),I;const{data:E,error:C}=await k.from("saved_images").insert(u).select().single();return C?C.code==="23505"||C.message?.includes("duplicate")?(console.log("‚ö†Ô∏è Unique constraint violation - image already exists"),h.current.delete(g),setTimeout(()=>x(),500),null):(console.error("Database insert failed:",{error:C,message:C.message,code:C.code,details:C.details,hint:C.hint}),null):(console.log("üéÜ Direct URL database insert successful!",E?"with data":"without returned data"),h.current.delete(g),setTimeout(()=>x(),500),E||{})}catch(j){return console.error("saveImage catch block:",j),h.current.delete(g),null}finally{h.current.delete(g)}},deleteImage:async c=>{if(!(!o||!i||!k))try{const d=t.find(g=>g.id===c);if(!d)return;let m=d.storage_file_path;if(!m){const g=d.image_url.split("/"),j=g.indexOf("generated_images");j!==-1&&(m=g.slice(j+1).join("/"))}if(m&&m.includes("undefined")&&(console.warn("Invalid file path detected, skipping storage deletion:",m),m=null),m)try{const g=m.startsWith("/")?m.slice(1):m;console.log("Attempting to delete file from storage:",g),console.log("File path details:",{original:m,cleaned:g,userId:i});const j=await ue(),{data:w,error:b}=await j?.storage.from("generated_images").remove([g])||{data:null,error:new Error("Storage client not available")};console.log("Storage deletion response:",{removeData:w,storageError:b}),b?console.warn("Storage deletion failed:",b):console.log("Successfully deleted file from storage:",g)}catch(g){console.warn("Storage deletion error:",g)}else console.warn("No file path available for storage deletion");const{error:f}=await k.from("saved_images").delete().eq("id",c).eq("user_id",i);if(f)throw f;s(g=>g.filter(j=>j.id!==c))}catch(d){throw d}},toggleFavorite:async c=>{if(!(!o||!i||!k))try{const d=t.find(j=>j.id===c);if(!d){console.warn("Image not found for favorite toggle:",c);return}const m=!d.is_favorite;console.log("Toggling favorite for image:",c,"from",d.is_favorite,"to",m);const{data:f,error:g}=await k.from("saved_images").update({is_favorite:m}).eq("id",c).eq("user_id",i).select().single();if(g)throw console.error("Error updating favorite status:",g),g;console.log("Database update successful, received data:",f),s(j=>j.map(w=>w.id===c?f&&typeof f=="object"&&f.id?(console.log("Updating image with database data:",f),f):(console.log("Updating image locally with new favorite status"),{...w,is_favorite:m}):w))}catch(d){throw console.error("Toggle favorite error:",d),d}},refreshImages:x}},me=({imageUrl:t,fullName:s,email:r,size:a="md",editable:n=!1,onImageChange:o,loading:i=!1})=>{const[x,h]=l.useState(!1),p={sm:{container:"w-8 h-8",icon:"w-3 h-3",text:"text-xs"},md:{container:"w-12 h-12",icon:"w-5 h-5",text:"text-sm"},lg:{container:"w-20 h-20",icon:"w-8 h-8",text:"text-lg"},xl:{container:"w-32 h-32",icon:"w-12 h-12",text:"text-2xl"}}[a],v=()=>s?s.split(" ").map(f=>f.charAt(0).toUpperCase()).slice(0,2).join(""):r?r.charAt(0).toUpperCase():"U",c=f=>{const g=f.target.files?.[0];if(g&&o){if(!g.type.startsWith("image/")||g.size>5*1024*1024)return;o(g)}},d=()=>{h(!0)};Ee.useEffect(()=>{h(!1)},[t]);const m=()=>{if(i)return e.jsx("div",{className:"flex items-center justify-center w-full h-full",children:e.jsx("div",{className:"w-1/2 h-1/2 rounded-full bg-white/20"})});if(t&&!x)return e.jsx("img",{src:t,alt:s||"Profile",onError:d,className:"w-full h-full object-cover"});const f=v();return f&&f!=="U"?e.jsx("span",{className:`font-semibold text-white ${p.text}`,children:f}):e.jsx(H,{className:`text-white ${p.icon}`})};return n?e.jsxs("div",{className:"relative",children:[e.jsxs("div",{className:`
          ${p.container} 
          rounded-full 
          bg-gradient-to-r from-blue-500 to-purple-600 
          flex items-center justify-center 
          overflow-hidden 
          border-2 border-white/20
          cursor-pointer
          group
          hover:scale-105
          transition-all duration-200
        `,children:[m(),e.jsx("div",{className:"absolute inset-0 bg-black/50 opacity-0 group-hover:opacity-100 transition-opacity duration-200 flex items-center justify-center",children:e.jsx(qe,{className:"w-1/3 h-1/3 text-white"})})]}),e.jsx("input",{type:"file",accept:"image/*",onChange:c,className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer",disabled:i}),n&&e.jsx("div",{className:"absolute -bottom-1 -right-1 w-6 h-6 bg-blue-500 rounded-full flex items-center justify-center border-2 border-white",children:e.jsx(He,{className:"w-3 h-3 text-white"})})]}):e.jsx("div",{className:`
      ${p.container} 
      rounded-full 
      bg-gradient-to-r from-blue-500 to-purple-600 
      flex items-center justify-center 
      overflow-hidden 
      border-2 border-white/20
    `,children:m()})},Et=({onShowAuth:t})=>{const[s,r]=l.useState(!1),{user:a,signOut:n,isConfigured:o}=G(),{showSuccess:i,showError:x}=L(),h=_e(),y=async()=>{try{await n(),r(!1),i("Signed Out Successfully","You have been signed out of your account.")}catch{x("Sign Out Failed","An error occurred while signing out. Please try again.")}},p=()=>{h("/my-images"),r(!1)},v=()=>{h("/profile"),r(!1)},c=()=>{a||t()};if(!o)return e.jsx("div",{className:"flex items-center gap-3",children:e.jsxs("button",{onClick:t,className:"glass glass-hover rounded-lg sm:rounded-xl px-3 sm:px-4 py-2 flex items-center gap-1.5 sm:gap-2 text-blue-400 hover:text-blue-300 transition-all duration-300",children:[e.jsx(H,{className:"w-4 h-4 sm:w-5 sm:h-5"}),e.jsx("span",{className:"text-xs sm:text-sm hidden sm:inline",children:"Connect Auth"})]})});if(!a)return e.jsx("div",{className:"flex items-center gap-3",children:e.jsxs("button",{onClick:c,className:"glass glass-hover rounded-lg sm:rounded-xl px-3 sm:px-4 py-2 flex items-center gap-1.5 sm:gap-2 text-blue-400 hover:text-blue-300 transition-all duration-300",children:[e.jsx(H,{className:"w-4 h-4 sm:w-5 sm:h-5"}),e.jsx("span",{className:"text-xs sm:text-sm hidden sm:inline",children:"Sign In"})]})});const d=It(a),m=St(a),f=kt(a);return e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>r(!s),className:"glass glass-hover rounded-lg sm:rounded-xl px-2 sm:px-4 py-2 flex items-center gap-1 sm:gap-2 text-white hover:text-blue-300 transition-all duration-300",children:[e.jsx(me,{imageUrl:f,fullName:d,email:m,size:"sm"}),e.jsx("span",{className:"hidden sm:inline text-sm",children:d||m?.split("@")[0]||"User"}),e.jsx(xe,{className:`w-4 h-4 transition-transform duration-200 ${s?"rotate-180":""}`})]}),s&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>r(!1)}),e.jsx("div",{className:"absolute right-0 top-full mt-2 w-56 sm:w-64 glass rounded-lg sm:rounded-xl border border-white/20 z-20 shadow-xl",children:e.jsxs("div",{className:"p-2 sm:p-3",children:[e.jsx("div",{className:"px-2 sm:px-3 py-2 sm:py-3 border-b border-white/10 mb-1.5 sm:mb-2",children:e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[e.jsx(me,{imageUrl:f,fullName:d,email:m,size:"md"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-xs sm:text-sm text-white font-medium truncate",children:d||"User"}),e.jsx("p",{className:"text-xs text-gray-400 truncate",children:m})]})]})}),e.jsxs("button",{onClick:v,className:"w-full flex items-center gap-2 sm:gap-3 px-2 sm:px-3 py-2 sm:py-2.5 text-xs sm:text-sm text-gray-300 hover:text-white hover:bg-white/10 rounded-lg transition-all duration-200",children:[e.jsx(Ye,{className:"w-4 h-4 flex-shrink-0"}),e.jsx("span",{children:"Profile"})]}),e.jsxs("button",{onClick:p,className:"w-full flex items-center gap-2 sm:gap-3 px-2 sm:px-3 py-2 sm:py-2.5 text-xs sm:text-sm text-gray-300 hover:text-white hover:bg-white/10 rounded-lg transition-all duration-200",children:[e.jsx(Me,{className:"w-4 h-4 flex-shrink-0"}),e.jsx("span",{children:"My Images"})]}),e.jsx("hr",{className:"border-white/10 my-1.5 sm:my-2"}),e.jsxs("button",{onClick:y,className:"w-full flex items-center gap-2 sm:gap-3 px-2 sm:px-3 py-2 sm:py-2.5 text-xs sm:text-sm text-red-400 hover:text-red-300 hover:bg-red-500/10 rounded-lg transition-all duration-200",children:[e.jsx(Ge,{className:"w-4 h-4 flex-shrink-0"}),e.jsx("span",{children:"Sign Out"})]})]})})]})]})};var _t=Ue();const ge={baseTheme:_t.dark,elements:{formButtonPrimary:"bg-blue-600 hover:bg-blue-700 text-white transition-colors",card:"bg-gray-900 border-gray-700 shadow-2xl relative",headerTitle:"text-white font-bold",headerSubtitle:"text-gray-300",socialButtonsBlockButton:"bg-gray-800 border-gray-600 text-white hover:bg-gray-700 transition-colors",socialButtonsBlockButtonText:"text-white",formFieldInput:"bg-gray-800 border-gray-600 text-white focus:border-blue-500 focus:ring-1 focus:ring-blue-500 transition-colors",formFieldLabel:"text-gray-300 font-medium",identityPreviewText:"text-gray-300",formFieldHintText:"text-gray-400 text-sm",formFieldErrorText:"text-red-400 text-sm",footerActionText:"text-gray-300",footerActionLink:"text-blue-400 hover:text-blue-300 transition-colors",dividerLine:"bg-gray-600",dividerText:"text-gray-400",formResendCodeLink:"text-blue-400 hover:text-blue-300 transition-colors",otpCodeFieldInput:"bg-gray-800 border-gray-600 text-white focus:border-blue-500 focus:ring-1 focus:ring-blue-500 transition-colors",formHeaderTitle:"text-white font-bold",formHeaderSubtitle:"text-gray-300",alertText:"text-gray-300",formFieldSuccessText:"text-green-400 text-sm",formFieldWarningText:"text-yellow-400 text-sm",formFieldInputShowPasswordButton:"text-gray-400 hover:text-gray-300 transition-colors",formFieldInputShowPasswordIcon:"text-gray-400",formFieldInputHidePasswordIcon:"text-gray-400",formFieldInputShowPasswordButtonHover:"text-gray-300",formFieldInputShowPasswordButtonActive:"text-gray-200",formFieldInputShowPasswordButtonFocus:"text-gray-200",formFieldInputShowPasswordButtonDisabled:"text-gray-500",formFieldInputShowPasswordButtonHoverDisabled:"text-gray-500",formFieldInputShowPasswordButtonActiveDisabled:"text-gray-500",formFieldInputShowPasswordButtonFocusDisabled:"text-gray-500",formFieldInputShowPasswordButtonHoverActive:"text-gray-200",formFieldInputShowPasswordButtonHoverFocus:"text-gray-200",formFieldInputShowPasswordButtonActiveFocus:"text-gray-200",formFieldInputShowPasswordButtonHoverActiveFocus:"text-gray-200",formFieldInputShowPasswordButtonHoverActiveDisabled:"text-gray-500",formFieldInputShowPasswordButtonHoverFocusDisabled:"text-gray-500",formFieldInputShowPasswordButtonActiveFocusDisabled:"text-gray-500",formFieldInputShowPasswordButtonHoverActiveFocusDisabled:"text-gray-500"}},Rt=({isOpen:t,onClose:s,initialMode:r="signin"})=>{const[a,n]=l.useState(r),[o,i]=l.useState(!1),{user:x}=he(),{isConfigured:h}=G(),{showSuccess:y}=L();return l.useEffect(()=>{x&&t&&(y("Welcome!","You have successfully signed in to your account."),s())},[x,t,s,y]),l.useEffect(()=>{if(t){n(r),i(!1);const p=setTimeout(()=>{i(!0)},500);return()=>{clearTimeout(p)}}else i(!1)},[t]),l.useEffect(()=>{if(!t)return;const p=v=>{const d=v.detail||"";d.includes("sign-up")&&n("signup"),d.includes("sign-in")&&n("signin")};return window.addEventListener("clerk:navigate",p),()=>window.removeEventListener("clerk:navigate",p)},[t]),l.useEffect(()=>{!t&&(window.location.pathname.startsWith("/sign-")||window.location.pathname.startsWith("/factor"))&&window.history.replaceState(null,"","/")},[t]),l.useEffect(()=>{if(!t)return;const p=a==="signup"?"/sign-up":"/sign-in";window.location.pathname!==p&&window.history.replaceState(null,"",p)},[t,a]),l.useEffect(()=>{t&&n(r)},[t,r]),t?h?e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"relative",children:[o&&e.jsx("button",{onClick:s,"aria-label":"Close authentication",className:"absolute top-4 right-4 z-50 text-gray-400 hover:text-white transition-all duration-300 bg-black/20 hover:bg-black/40 rounded-full p-2 animate-fade-in",children:e.jsx(Z,{className:"w-5 h-5"})}),a==="signin"?e.jsx($e,{path:"/sign-in",signUpUrl:"/sign-up",afterSignInUrl:"/",redirectUrl:"/",routing:"path",appearance:ge}):e.jsx(Le,{path:"/sign-up",signInUrl:"/sign-in",afterSignUpUrl:"/",redirectUrl:"/",routing:"path",appearance:ge})]})}):e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-gray-800 rounded-2xl p-8 max-w-md w-full border border-gray-700",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-white",children:"Authentication Required"}),e.jsx("button",{onClick:s,className:"text-gray-400 hover:text-white transition-colors",children:e.jsx(Z,{className:"w-6 h-6"})})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"mb-4",children:e.jsx("div",{className:"w-16 h-16 bg-yellow-500/20 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(H,{className:"w-8 h-8 text-yellow-400"})})}),e.jsx("h3",{className:"text-lg font-semibold text-white mb-2",children:"Clerk Configuration Required"}),e.jsx("p",{className:"text-gray-300 mb-6",children:"To enable user authentication, please configure your Clerk project and add the publishable key to your environment variables."}),e.jsx("div",{className:"bg-gray-800 rounded-lg p-4 mb-6",children:e.jsx("code",{className:"text-green-400 text-sm",children:"VITE_CLERK_PUBLISHABLE_KEY=pk_test_..."})}),e.jsx("button",{onClick:s,className:"bg-gray-700 hover:bg-gray-600 rounded-xl px-6 py-3 text-blue-400 font-medium transition-all duration-300",children:"Close"})]})]})}):null},Pt=()=>{const[t,s]=l.useState(!1);return e.jsxs(e.Fragment,{children:[e.jsx("header",{className:"relative py-4 sm:py-6 md:py-8 px-3 sm:px-4",children:e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsx("div",{className:"flex justify-end mb-4 sm:mb-6 md:mb-8",children:e.jsx(Et,{onShowAuth:()=>s(!0)})}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"flex items-center justify-center mb-3 sm:mb-4",children:e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute -inset-1 bg-gradient-to-r from-blue-500 via-purple-500 to-pink-500 rounded-full blur opacity-75 pulse-glow"}),e.jsx("div",{className:"relative glass rounded-full p-2 sm:p-3",children:e.jsx(re,{className:"w-6 h-6 sm:w-8 sm:h-8 text-blue-400"})})]})}),e.jsx("h1",{className:"text-2xl sm:text-3xl md:text-5xl lg:text-6xl font-bold mb-3 sm:mb-4 px-2",children:e.jsx("span",{className:"gradient-text",children:"Free AI Image Generator"})}),e.jsx("p",{className:"text-sm sm:text-base md:text-lg lg:text-xl text-gray-300 mb-4 sm:mb-6 max-w-2xl mx-auto px-4",children:"Transform your imagination into stunning visuals with completely free AI image generation. No API keys, no limits, no costs - just pure creativity unleashed!"}),e.jsxs("div",{className:"flex flex-wrap items-center justify-center gap-2 sm:gap-4 text-xs sm:text-sm text-gray-400 px-4",children:[e.jsxs("div",{className:"flex items-center gap-1.5 sm:gap-2",children:[e.jsx(fe,{className:"w-3.5 h-3.5 sm:w-4 sm:h-4 text-yellow-400"}),e.jsx("span",{children:"Lightning Fast"})]}),e.jsx("div",{className:"hidden sm:block w-1 h-1 bg-gray-600 rounded-full"}),e.jsxs("div",{className:"flex items-center gap-1.5 sm:gap-2",children:[e.jsx(Je,{className:"w-3.5 h-3.5 sm:w-4 sm:h-4 text-green-400"}),e.jsx("span",{children:"Unlimited Free"})]}),e.jsx("div",{className:"hidden sm:block w-1 h-1 bg-gray-600 rounded-full"}),e.jsxs("div",{className:"flex items-center gap-1.5 sm:gap-2",children:[e.jsx(re,{className:"w-3.5 h-3.5 sm:w-4 sm:h-4 text-purple-400"}),e.jsx("span",{children:"High Quality"})]})]})]})]})}),e.jsx(Rt,{isOpen:t,onClose:()=>s(!1)})]})},ve=l.forwardRef(({onGenerate:t,isGenerating:s},r)=>{const[a,n]=l.useState(""),[o,i]=l.useState("1:1"),[x,h]=l.useState("vivid"),[y,p]=l.useState(!1),v=l.useRef(null),c=l.useRef(null),d=l.useRef(!1),m=u=>{u.preventDefault(),!d.current&&a.trim()&&!s&&(d.current=!0,t({prompt:a.trim(),aspectRatio:o,generationStyle:x}),setTimeout(()=>{d.current=!1},500))},f=()=>{const u=c.current;u&&(u.style.height="auto",u.style.height=`${Math.min(u.scrollHeight,200)}px`)},g=u=>{n(u.target.value),f()};l.useEffect(()=>{f()},[a]),l.useImperativeHandle(r,()=>({focus:()=>{c.current&&c.current.focus()}}),[]);const j=["A serene mountain landscape at sunset","Cyberpunk city with neon lights","Magical forest with glowing mushrooms","Futuristic spaceship in deep space","Abstract geometric art in vibrant colors","Cozy cottage in a snowy winter scene","Majestic dragon soaring through clouds","Underwater coral reef with tropical fish"],w=[{value:"1:1",label:"Square",ratio:"1:1",description:"Perfect for social media posts",icon:"‚¨ú",dimensions:"512√ó512"},{value:"16:9",label:"Landscape",ratio:"16:9",description:"Great for wallpapers and presentations",icon:"üñ•Ô∏è",dimensions:"768√ó432"},{value:"4:3",label:"Classic",ratio:"4:3",description:"Traditional photo format",icon:"üì∑",dimensions:"640√ó480"}],b=[{value:"vivid",label:"Vivid Style",description:"Bold & Dramatic Images",icon:"üé®",features:["High Contrast","Vibrant Colors","Artistic"],color:"from-purple-500 to-pink-600",borderColor:"border-purple-500/30"},{value:"natural",label:"Natural Style",description:"Realistic & Subtle",icon:"üåø",features:["Photo-realistic","Natural Colors","Balanced"],color:"from-blue-500 to-cyan-600",borderColor:"border-blue-500/30"}];return e.jsxs("div",{className:"max-w-4xl mx-auto px-3 sm:px-4 mb-6 sm:mb-8 md:mb-12",children:[e.jsx("form",{ref:v,onSubmit:m,className:"relative",children:e.jsxs("div",{className:"glass rounded-xl sm:rounded-2xl p-1",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center gap-2 sm:gap-4 p-2 sm:p-4",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(We,{className:"absolute left-3 sm:left-4 top-3 sm:top-4 w-4 h-4 sm:w-5 sm:h-5 text-gray-400"}),e.jsx("textarea",{ref:c,value:a,onChange:g,onKeyDown:u=>{u.key==="Enter"&&!u.shiftKey&&(u.preventDefault(),v.current?.requestSubmit())},placeholder:"Describe the image you want to generate...",className:"w-full pl-10 sm:pl-12 pr-3 sm:pr-4 py-3 sm:py-4 bg-transparent text-white placeholder-gray-400 text-sm sm:text-base md:text-lg focus:outline-none resize-none overflow-y-auto min-h-[48px] sm:min-h-[56px] max-h-[200px] scrollbar-thin scrollbar-thumb-gray-600 scrollbar-track-transparent hover:scrollbar-thumb-gray-500",disabled:s,rows:1})]}),e.jsxs("div",{className:"flex sm:flex-col gap-2 w-full sm:w-auto",children:[e.jsxs("button",{type:"button",onClick:()=>p(!y),className:`glass-hover rounded-lg sm:rounded-xl p-2 sm:p-4 transition-all duration-300 relative flex-1 sm:flex-none ${y?"text-blue-400 bg-blue-500/20 shadow-lg shadow-blue-500/25":"text-gray-400 hover:text-white"}`,title:"Settings",children:[e.jsxs("div",{className:"flex items-center justify-center sm:gap-2",children:[e.jsx(Ve,{className:"w-4 h-4 sm:w-5 sm:h-5"}),e.jsx("span",{className:"sm:hidden ml-1.5 text-xs",children:"Settings"}),y?e.jsx(Ke,{className:"hidden sm:block w-4 h-4"}):e.jsx(xe,{className:"hidden sm:block w-4 h-4"})]}),y&&e.jsx("div",{className:"absolute -top-1 -right-1 w-2.5 h-2.5 sm:w-3 sm:h-3 bg-blue-500 rounded-full"})]}),e.jsxs("button",{type:"submit",disabled:!a.trim()||s,className:"glass-hover rounded-lg sm:rounded-xl px-4 sm:px-6 py-2 sm:py-4 flex items-center justify-center gap-1.5 sm:gap-2 text-white font-medium transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed relative overflow-hidden group flex-1 sm:flex-none",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-blue-500 to-purple-600 opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),e.jsxs("div",{className:"relative flex items-center gap-1.5 sm:gap-2",children:[e.jsx(Ze,{className:"w-4 h-4 sm:w-5 sm:h-5"}),e.jsx("span",{className:"text-sm sm:text-base",children:"Generate"})]})]})]})]}),y&&e.jsx("div",{className:"border-t border-white/20 bg-gray-800/30 backdrop-blur-sm",children:e.jsxs("div",{className:"p-3 sm:p-4 md:p-6 space-y-4 sm:space-y-6 md:space-y-8",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("h3",{className:"text-base sm:text-lg font-semibold text-white mb-1 sm:mb-2",children:"Generation Settings"}),e.jsx("p",{className:"text-xs sm:text-sm text-gray-400",children:"Customize your AI image generation"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm sm:text-base text-white mb-3 sm:mb-4 font-semibold flex items-center gap-2",children:[e.jsx(ae,{className:"w-4 h-4 sm:w-5 sm:h-5 text-purple-400"}),"Choose Generation Style"]}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4",children:b.map(u=>e.jsxs("button",{type:"button",onClick:()=>h(u.value),className:`relative p-3 sm:p-4 rounded-lg sm:rounded-xl text-left transition-all duration-300 transform hover:scale-105 ${x===u.value?`bg-gradient-to-br ${u.color} text-white shadow-lg shadow-purple-500/25 ring-2 ring-purple-400`:"glass glass-hover text-gray-300 hover:bg-white/15"}`,children:[e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 mb-1.5 sm:mb-2",children:[e.jsx("span",{className:"text-xl sm:text-2xl",children:u.icon}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold text-sm sm:text-base",children:u.label}),e.jsx("div",{className:"text-xs sm:text-sm opacity-80",children:u.description})]})]}),e.jsx("div",{className:"flex flex-wrap gap-1 mb-2",children:u.features.map((I,E)=>e.jsx("span",{className:"text-xs px-2 py-1 rounded-full bg-white/20 opacity-75",children:I},E))}),x===u.value&&e.jsx("div",{className:"absolute top-2 right-2 w-6 h-6 bg-white rounded-full flex items-center justify-center",children:e.jsx("div",{className:"w-3 h-3 bg-purple-500 rounded-full"})})]},u.value))})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm sm:text-base text-white mb-3 sm:mb-4 font-semibold flex items-center gap-2",children:[e.jsx(Y,{className:"w-4 h-4 sm:w-5 sm:h-5 text-blue-400"}),"Choose Aspect Ratio"]}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-3 sm:gap-4",children:w.map(u=>e.jsxs("button",{type:"button",onClick:()=>i(u.value),className:`relative p-3 sm:p-4 rounded-lg sm:rounded-xl text-left transition-all duration-300 transform hover:scale-105 ${o===u.value?"bg-gradient-to-br from-blue-500 to-purple-600 text-white shadow-lg shadow-blue-500/25 ring-2 ring-blue-400":"glass glass-hover text-gray-300 hover:bg-white/15"}`,children:[e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 mb-1.5 sm:mb-2",children:[e.jsx("span",{className:"text-xl sm:text-2xl",children:u.icon}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold text-sm sm:text-base",children:u.label}),e.jsx("div",{className:"text-xs sm:text-sm opacity-80",children:u.ratio})]})]}),e.jsx("div",{className:"text-xs opacity-75 mb-1 sm:mb-2",children:u.description}),e.jsxs("div",{className:"text-xs font-mono opacity-60",children:[u.dimensions,"px"]}),o===u.value&&e.jsx("div",{className:"absolute top-2 right-2 w-6 h-6 bg-white rounded-full flex items-center justify-center",children:e.jsx("div",{className:"w-3 h-3 bg-blue-500 rounded-full"})})]},u.value))})]}),e.jsxs("div",{className:"glass rounded-lg sm:rounded-xl p-3 sm:p-4 bg-gradient-to-r from-purple-500/10 to-blue-500/10 border border-purple-500/30",children:[e.jsx("div",{className:"text-xs sm:text-sm text-purple-300 mb-2 font-medium",children:"Ready to Generate:"}),e.jsxs("div",{className:"flex flex-wrap items-center justify-center gap-2 sm:gap-4 text-xs sm:text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ae,{className:"w-4 h-4 text-purple-400"}),e.jsx("span",{className:"text-gray-300",children:b.find(u=>u.value===x)?.label})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Y,{className:"w-4 h-4 text-blue-400"}),e.jsxs("span",{className:"text-gray-300",children:[w.find(u=>u.value===o)?.label," (",o,")"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(fe,{className:"w-4 h-4 text-green-400"}),e.jsx("span",{className:"text-gray-300",children:"100% Free"})]})]})]})]})})]})}),e.jsxs("div",{className:"mt-4 sm:mt-6",children:[e.jsx("p",{className:"text-xs sm:text-sm text-gray-400 mb-2 sm:mb-3 text-center",children:"‚ú® Try these creative prompts:"}),e.jsx("div",{className:"flex flex-wrap gap-1.5 sm:gap-2 justify-center",children:j.map((u,I)=>e.jsx("button",{onClick:()=>n(u),disabled:s,className:"glass glass-hover rounded-full px-3 sm:px-4 py-1.5 sm:py-2 text-xs sm:text-sm text-gray-300 transition-all duration-300 hover:text-white disabled:opacity-50",children:u},I))})]})]})});ve.displayName="PromptInput";const Tt=async t=>{if(navigator.clipboard&&window.isSecureContext)try{await navigator.clipboard.writeText(t);return}catch{}const s=document.createElement("textarea");s.value=t,s.style.position="fixed",s.style.top="-9999px",s.style.left="-9999px",document.body.appendChild(s),s.focus(),s.select();try{if(!document.execCommand("copy"))throw new Error("execCommand returned false")}catch{throw new Error("Fallback copy method failed.")}finally{document.body.removeChild(s)}},At=async(t,s,r,a)=>{try{const n=await fetch(t);if(!n.ok)throw new Error(`Failed to fetch image: ${n.status}`);const o=await n.blob(),i=window.URL.createObjectURL(o),x=document.createElement("a");x.href=i,x.download=s,document.body.appendChild(x),x.click(),document.body.removeChild(x),window.URL.revokeObjectURL(i),r?.()}catch(n){console.error("Download error:",n);try{const o=document.createElement("a");o.href=t,o.download=s,o.target="_blank",document.body.appendChild(o),o.click(),document.body.removeChild(o),r?.()}catch(o){console.error("Fallback download error:",o),a?.(n)}}},Ft=(t="1:1",s,r="jpg")=>{const a=new Date().toISOString().split("T")[0];return`ai-generated-${t}-${s}-${a}.${r}`},Ut=({image:t})=>{const[s,r]=l.useState("idle"),[a,n]=l.useState(!1),[o,i]=l.useState(!1),[x,h]=l.useState(!1),{showSuccess:y,showError:p}=L(),v=async()=>{if(a)return;n(!0);const g=Ft(t.aspectRatio||"1:1",t.id);await At(t.url,g,()=>{y("Download Started","Your image is being downloaded.")},j=>{p("Download Failed","Could not download the image. Please try again.")}),n(!1)},c=async()=>{try{await Tt(t.prompt),r("success"),y("Prompt Copied!","The image prompt has been copied to your clipboard.")}catch{r("error"),p("Copy Failed","Could not copy the prompt to clipboard. Please try copying manually."),alert(`Could not copy automatically. Please copy this prompt manually:

"${t.prompt}"`)}setTimeout(()=>r("idle"),2e3)},d=g=>new Intl.RelativeTimeFormat("en",{numeric:"auto"}).format(Math.ceil((g.getTime()-Date.now())/(1e3*60)),"minute"),m=g=>{switch(g){case"16:9":return"aspect-video";case"4:3":return"aspect-[4/3]";case"1:1":default:return"aspect-square"}},f=g=>{switch(g){case"16:9":return"Landscape";case"4:3":return"Classic";case"1:1":default:return"Square"}};return t.isLoading?e.jsxs("div",{className:"glass rounded-xl overflow-hidden w-full max-w-sm mx-auto min-h-[400px] flex flex-col",children:[e.jsx("div",{className:`bg-gray-800 relative overflow-hidden flex-1 ${m(t.aspectRatio)}`,children:e.jsx("div",{className:"absolute inset-0 bg-gray-700/40"})}),e.jsxs("div",{className:"p-4",children:[e.jsx("div",{className:"h-4 bg-gray-700 rounded mb-2"}),e.jsx("div",{className:"h-3 bg-gray-700 rounded w-2/3"})]})]}):e.jsxs("div",{className:"glass rounded-xl overflow-hidden group hover:scale-105 transition-all duration-300 floating-animation w-full max-w-sm mx-auto min-h-[400px] flex flex-col animate-fade-in-up","data-image-id":t.id,children:[e.jsxs("div",{className:"relative overflow-hidden flex-1",children:[x?e.jsx("div",{className:`w-full h-full bg-gray-800 flex items-center justify-center ${m(t.aspectRatio)}`,children:e.jsxs("div",{className:"text-center text-gray-400",children:[e.jsx("div",{className:"text-2xl mb-2",children:"‚ö†Ô∏è"}),e.jsx("div",{className:"text-sm",children:"Image failed to load"}),e.jsx("button",{onClick:()=>{h(!1),i(!1)},className:"mt-2 text-xs text-blue-400 hover:text-blue-300 underline",children:"Retry"})]})}):e.jsx("img",{src:t.url,alt:t.prompt,className:`w-full h-full object-cover transition-transform duration-300 group-hover:scale-110 ${m(t.aspectRatio)} ${o?"opacity-100":"opacity-0"}`,loading:"eager",decoding:"async",fetchpriority:"high",onLoad:()=>{i(!0);const g=document.querySelector(`[data-image-id="${t.id}"]`);g?.classList.add("animate-pulse"),setTimeout(()=>g?.classList.remove("animate-pulse"),300)},onError:()=>{h(!0),console.warn("Failed to load image:",t.url)}}),!o&&!x&&e.jsx("div",{className:`absolute inset-0 bg-gray-800 flex items-center justify-center ${m(t.aspectRatio)}`,children:e.jsxs("div",{className:"text-center text-gray-400",children:[e.jsx("div",{className:"w-8 h-8 border-2 border-gray-600 border-t-blue-400 rounded-full animate-spin mx-auto mb-2"}),e.jsx("div",{className:"text-sm",children:"Loading image..."})]})}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/50 via-transparent to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),e.jsx("div",{className:"absolute top-3 left-3 opacity-0 group-hover:opacity-100 transition-opacity duration-300",children:e.jsx("div",{className:"glass rounded-lg px-2 py-1 text-xs text-white border border-white/20",children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Y,{className:"w-3 h-3"}),e.jsx("span",{children:t.aspectRatio||"1:1"})]})})}),e.jsxs("div",{className:"absolute top-3 right-3 flex gap-2 opacity-0 group-hover:opacity-100 transition-opacity duration-300",children:[e.jsx("button",{onClick:v,disabled:a,className:`glass glass-hover rounded-full p-2 text-white transition-colors duration-300 ${a?"opacity-50 cursor-not-allowed":"hover:text-blue-400"}`,title:a?"Downloading...":"Download image",children:a?e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}):e.jsx(Xe,{className:"w-4 h-4"})}),e.jsx("button",{onClick:c,className:`glass glass-hover rounded-full p-2 text-white transition-colors duration-300 ${s==="success"?"text-green-400":s==="error"?"text-red-400":"hover:text-green-400"}`,title:s==="success"?"Copied!":s==="error"?"Copy failed":"Copy prompt",children:s==="success"?e.jsx(Qe,{className:"w-4 h-4"}):e.jsx(et,{className:"w-4 h-4"})})]}),s!=="idle"&&e.jsx("div",{className:"absolute bottom-3 right-3 opacity-0 group-hover:opacity-100 transition-opacity duration-300",children:e.jsx("div",{className:`glass rounded-lg px-3 py-1 text-sm ${s==="success"?"text-green-400 border-green-500/30":"text-red-400 border-red-500/30"}`,children:s==="success"?"Copied!":"Failed"})})]}),e.jsxs("div",{className:"p-4",children:[e.jsx("p",{className:"text-gray-300 text-sm line-clamp-2 mb-3",children:t.prompt}),e.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-500",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(tt,{className:"w-3 h-3"}),e.jsx("span",{children:d(t.timestamp)})]}),e.jsxs("div",{className:"flex items-center gap-1 text-gray-400",children:[e.jsx(Y,{className:"w-3 h-3"}),e.jsx("span",{children:f(t.aspectRatio)})]})]})]})]})},je=l.forwardRef(({images:t},s)=>t.length===0?e.jsx("div",{className:"max-w-4xl mx-auto px-4 text-center py-16",children:e.jsxs("div",{className:"glass rounded-2xl p-12",children:[e.jsx(st,{className:"w-16 h-16 text-gray-500 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl text-gray-400 mb-2",children:"No images yet"}),e.jsx("p",{className:"text-gray-500",children:"Generate your first AI image by entering a prompt above!"})]})}):e.jsxs("div",{ref:s,className:"max-w-7xl mx-auto px-3 sm:px-4",children:[e.jsxs("div",{className:"mb-4 sm:mb-6 md:mb-8",children:[e.jsx("h2",{className:"text-xl sm:text-2xl font-bold text-white mb-1 sm:mb-2",children:"Your Generated Images"}),e.jsxs("p",{className:"text-gray-400",children:[t.filter(r=>!r.isLoading).length," image",t.filter(r=>!r.isLoading).length!==1?"s":""," generated"]})]}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-4 gap-4 sm:gap-5 md:gap-6",children:t.map(r=>e.jsx(Ut,{image:r},r.id))})]}));je.displayName="ImageGrid";const $t=()=>e.jsx("footer",{className:"mt-10 sm:mt-16 md:mt-20 py-6 sm:py-8 px-3 sm:px-4 border-t border-white/10",children:e.jsxs("div",{className:"max-w-4xl mx-auto text-center",children:[e.jsxs("div",{className:"flex items-center justify-center gap-4 sm:gap-6 mb-3 sm:mb-4",children:[e.jsx("a",{href:"https://github.com/dumindu2041329",target:"_blank",rel:"noopener noreferrer",className:"text-gray-400 hover:text-blue-400 transition-colors duration-300",title:"GitHub",children:e.jsx(rt,{className:"w-5 h-5 sm:w-6 sm:h-6"})}),e.jsx("a",{href:"https://www.linkedin.com/in/dumindu-damsara-0049ab246/",target:"_blank",rel:"noopener noreferrer",className:"text-gray-400 hover:text-blue-400 transition-colors duration-300",title:"LinkedIn",children:e.jsx(at,{className:"w-5 h-5 sm:w-6 sm:h-6"})})]}),e.jsxs("p",{className:"text-xs sm:text-sm text-gray-500",children:["¬© ",new Date().getFullYear()," AI Image Generator. All rights reserved."]})]})}),q=()=>{const[t,s]=l.useState([]),[r,a]=l.useState(!1),{saveImage:n}=Ct(),{user:o,isConfigured:i}=G(),{showSuccess:x,showError:h,showWarning:y}=L(),p=l.useRef(o),v=l.useRef(null),c=l.useRef(null);l.useEffect(()=>{p.current&&!o&&s([]),p.current=o},[o]);const d=m=>{a(!0);const f=performance.now();try{const g=de.generateImage(m),j=Math.round(performance.now()-f);de.preloadImage(g.url).catch(()=>{}),s(w=>[g,...w]),x("Image Generated Instantly!",`Created a ${m.aspectRatio||"1:1"} image in ${j}ms using Pollinations AI.`),setTimeout(()=>{v.current&&v.current.scrollIntoView({behavior:"smooth",block:"start",inline:"nearest"})},50),i&&o&&n(m.prompt,g.url,m.aspectRatio||"1:1",m.generationStyle||"vivid").then(()=>{setTimeout(()=>{x("Image Saved!","Your generated image has been saved to your history.")},1e3)}).catch(w=>{console.warn("Save to history failed:",w),setTimeout(()=>{y("Image Generated Successfully","Your image was created but could not be saved to your history. The image is still available above!")},1e3)})}catch(g){g instanceof Error?h("Image Generation Failed",g.message):h("Image Generation Failed","An unexpected error occurred. Please try again.")}finally{setTimeout(()=>a(!1),100)}};return e.jsxs("div",{className:"min-h-screen",children:[e.jsxs("div",{className:"fixed inset-0 overflow-hidden pointer-events-none",children:[e.jsx("div",{className:"absolute -top-40 -right-40 w-80 h-80 bg-purple-500/20 rounded-full blur-3xl"}),e.jsx("div",{className:"absolute -bottom-40 -left-40 w-80 h-80 bg-blue-500/20 rounded-full blur-3xl"})]}),e.jsxs("div",{className:"relative z-10",children:[e.jsx(Pt,{}),i&&o&&e.jsx("div",{className:"max-w-4xl mx-auto px-3 sm:px-4 mb-4 sm:mb-6",children:e.jsx("div",{className:"glass rounded-xl sm:rounded-2xl p-3 sm:p-4 border-l-4 border-green-500",children:e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[e.jsx("div",{className:"w-5 h-5 sm:w-6 sm:h-6 bg-green-500 rounded-full flex items-center justify-center flex-shrink-0",children:e.jsx("span",{className:"text-white text-xs sm:text-sm font-bold",children:"‚úì"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-green-200 font-medium text-sm sm:text-base",children:"Authentication Active"}),e.jsx("p",{className:"text-green-300 text-xs sm:text-sm",children:"Your generated images are automatically saved to your history!"})]})]})})}),e.jsx(ve,{ref:c,onGenerate:d,isGenerating:r}),e.jsx(je,{ref:v,images:t}),e.jsx($t,{})]})]})},Lt=l.lazy(()=>M(()=>import("./MyImagesPage-j1bS6M-T.js"),__vite__mapDeps([0,1,2,3,4,5]))),Dt=l.lazy(()=>M(()=>import("./ProfilePage-BIV9J65E.js"),__vite__mapDeps([6,1,2,3,4,5]))),Bt=l.lazy(()=>M(()=>import("./AuthConfirmPage-pt8O6gMj.js"),__vite__mapDeps([7,1,2,3,4,5]))),Ot=l.lazy(()=>M(()=>import("./ResetPasswordPage-Kr8zNiZf.js"),__vite__mapDeps([8,1,2,3,4,5])));function zt(){return $.includes("YOUR_CLERK_PUBLISHABLE_KEY")?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-purple-900 via-blue-900 to-indigo-900 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-gray-800 rounded-2xl p-8 max-w-md w-full border border-gray-700 text-center",children:[e.jsx("h1",{className:"text-2xl font-bold text-white mb-4",children:"Clerk Configuration Required"}),e.jsx("p",{className:"text-gray-300 mb-6",children:"Please add your Clerk publishable key to the .env file to enable authentication."}),e.jsx("div",{className:"bg-gray-800 rounded-lg p-4 text-left",children:e.jsx("code",{className:"text-green-400 text-sm",children:"VITE_CLERK_PUBLISHABLE_KEY=pk_test_..."})})]})}):e.jsx(De,{publishableKey:$,routerPush:t=>{window.history.pushState(null,"",t),window.dispatchEvent(new CustomEvent("clerk:navigate",{detail:t}))},routerReplace:t=>{window.history.replaceState(null,"",t),window.dispatchEvent(new CustomEvent("clerk:navigate",{detail:t}))},children:e.jsx(wt,{children:e.jsxs(Re,{children:[e.jsxs(Pe,{children:[e.jsx(R,{path:"/",element:e.jsx(q,{})}),e.jsx(R,{path:"/sign-in",element:e.jsx(q,{})}),e.jsx(R,{path:"/sign-up",element:e.jsx(q,{})}),e.jsx(R,{path:"/factor-one",element:e.jsx(q,{})}),e.jsx(R,{path:"/my-images",element:e.jsx(l.Suspense,{fallback:null,children:e.jsx(Lt,{})})}),e.jsx(R,{path:"/profile",element:e.jsx(l.Suspense,{fallback:null,children:e.jsx(Dt,{})})}),e.jsx(R,{path:"/auth/confirm",element:e.jsx(l.Suspense,{fallback:null,children:e.jsx(Bt,{})})}),e.jsx(R,{path:"/reset-password",element:e.jsx(l.Suspense,{fallback:null,children:e.jsx(Ot,{})})})]}),e.jsx(yt,{})]})})})}const Ne=document.getElementById("root");if(!Ne)throw new Error("Root element not found");const qt=pt.createRoot(Ne);qt.render(e.jsxs(l.StrictMode,{children:[e.jsx(zt,{}),e.jsx(xt,{})]}));export{me as P,G as a,L as b,St as c,It as d,kt as e,Nt as g,e as j,Ct as u};
